
define firewalls::rules ($rule1=undef, $rule2=undef, $rule3=undef, $rule4=undef){

  if ($rule1 != undef) {
    $_title1 = $rule1["title"]
    $_name1 = $rule1["name"]
    $_proto1  = $rule1["proto"]
    $_action1 = $rule1["action"]
    $_sport1  = $rule1["sport"]
    $_dport1  = $rule1["dport"]
    $_state1  = $rule1["state"]
    $_source1 = $rule1["source"]
    $_src_range1 = $rule1["src_range"]
    $_destination1 = $rule1["destination"]
    $_dst_range1 = $rule1["dst_range"]
    $_iniface1 = $rule1["iniface"]
    $_outiface1 = $rule1["outiface"]
    $_icmp1 = $rule1["icmp"]
    $_chain1 = $rule1["chain"]
    $_provider1 = $rule1["provider"]
    $_log_level1 = $rule1["log_level"]
    $_log_prefix1 = $rule1["log_prefix"]
    $_jump1 = $rule1["jump"]
    $_limit1 = $rule1["limit"]
    $_table1 = $rule1["table"]
    $_toports1 = $rule1["toports"]
    $_setports1 = $rule1["setports"]
    $_setdscp1 = $rule1["setdscp"]
    $_ensure1 = $rule1["ensure"]
    $_tosource1  = $rule1["tosource"]
    $_algo1 = $rule1["algo"]
    $_string1 = $rule1["string"]

    rule { "${_title1}_1":
        name        => $_name1,
        proto       => $_proto1,
        action      => $_action1,
        sport       => $_sport1,
        dport       => $_dport1,
        state       => $_state1,
        source      => $_source1,
        src_range   => $_src_range1,
        destination => $_destination1,
        dst_range   => $_dst_range1,
        iniface     => $_iniface1,
        outiface    => $_outiface1,
        icmp        => $_icmp1,
        chain       => $_chain1,
        provider    => $_provider1,
        log_level   => $_log_level1,
        log_prefix  => $_log_prefix1,
        jump        => $_jump1,
        limit       => $_limit1,
        table       => $_table1,
        toports     => $_toports1,
        setdscp     => $_setdscp1,
        ensure      => $_ensure1,
        tosource    => $_tosource1,
        string      => $_string1,
        algo        => $_algo1,
    }
  }
  if ($rule2 != undef) {
    $_title2 = $rule2["title"]
    $_name2 = $rule2["name"]
    $_proto2 = $rule2["proto"]
    $_action2 = $rule2["action"]
    $_sport2 = $rule2["sport"]
    $_dport2 = $rule2["dport"]
    $_state2 = $rule2["state"]
    $_source2= $rule2["source"]
    $_src_range2 = $rule2["src_range"]
    $_destination2 = $rule2["destination"]
    $_dst_range2 = $rule2["dst_range"]
    $_iniface2 = $rule2["iniface"]
    $_outiface2 = $rule2["outiface"]
    $_icmp2 = $rule2["icmp"]
    $_chain2 = $rule2["chain"]
    $_provider2 = $rule2["provider"]
    $_log_level2 = $rule2["log_level"]
    $_log_prefix2 = $rule2["log_prefix"]
    $_jump2 = $rule2["jump"]
    $_limit2 = $rule2["limit"]
    $_table2 = $rule2["table"]
    $_toports2 = $rule2["toports"]
    $_setports2 = $rule2["setports"]
    $_setdscp2 = $rule2["setdscp"]
    $_ensure2 = $rule2["ensure"]
    $_tosource2  = $rule2["tosource"]
    $_algo2 = $rule2["algo"]
    $_string2 = $rule2["string"]

    rule { "${_title2}_2":
        name        => $_name2,
        proto       => $_proto2,
        action      => $_action2,
        sport       => $_sport2,
        dport       => $_dport2,
        state       => $_state2,
        source      => $_source2,
        src_range   => $_src_range2,
        destination => $_destination2,
        dst_range   => $_dst_range2,
        iniface     => $_iniface2,
        outiface    => $_outiface2,
        icmp        => $_icmp2,
        chain       => $_chain2,
        provider    => $_provider2,
        log_level   => $_log_level2,
        log_prefix  => $_log_prefix2,
        jump        => $_jump2,
        limit       => $_limit2,
        table       => $_table2,
        toports     => $_toports2,
        setdscp     => $_setdscp2,
        ensure      => $_ensure2,
        tosource    => $_tosource2,
        string      => $_string2,
        algo        => $_algo2,
    }
  }
  if ($rule3 != undef) {
    $_title3 = $rule3["title"]
    $_name3 = $rule3["name"]
    $_proto3 = $rule3["proto"]
    $_action3 = $rule3["action"]
    $_sport3 = $rule3["sport"]
    $_dport3 = $rule3["dport"]
    $_state3 = $rule3["state"]
    $_source3 = $rule3["source"]
    $_src_range3 = $rule3["src_range"]
    $_destination3 = $rule3["destination"]
    $_dst_range3 = $rule3["dst_range"]
    $_iniface3 = $rule3["iniface"]
    $_outiface3 = $rule3["outiface"]
    $_icmp3 = $rule3["icmp"]
    $_chain3 = $rule3["chain"]
    $_provider3 = $rule3["provider"]
    $_log_level3 = $rule3["log_level"]
    $_log_prefix3 = $rule3["log_prefix"]
    $_jump3 = $rule3["jump"]
    $_limit3 = $rule3["limit"]
    $_table3 = $rule3["table"]
    $_toports3 = $rule3["toports"]
    $_setports3 = $rule3["setports"]
    $_setdscp3 = $rule3["setdscp"]
    $_ensure3 = $rule3["ensure"]
    $_tosource3  = $rule3["tosource"]
    $_algo3 = $rule3["algo"]
    $_string3 = $rule3["string"]

    rule { "${_title3}_3":
        name        => $_name3,
        proto       => $_proto3,
        action      => $_action3,
        sport       => $_sport3,
        dport       => $_dport3,
        state       => $_state3,
        source      => $_source3,
        src_range   => $_src_range3,
        destination => $_destination3,
        dst_range   => $_dst_range3,
        iniface     => $_iniface3,
        outiface    => $_outiface3,
        icmp        => $_icmp3,
        chain       => $_chain3,
        provider    => $_provider3,
        log_level   => $_log_level3,
        log_prefix  => $_log_prefix3,
        jump        => $_jump3,
        limit       => $_limit3,
        table       => $_table3,
        toports     => $_toports3,
        setdscp     => $_setdscp3,
        ensure      => $_ensure3,
        tosource    => $_tosource3,
        string      => $_string3,
        algo        => $_algo3,
    }
  }
  if ($rule4 != undef) {
    $_title4 = $rule4["title"]
    $_name4 = $rule4["name"]
    $_proto4 = $rule4["proto"]
    $_action4 = $rule4["action"]
    $_sport4 = $rule4["sport"]
    $_dport4 = $rule4["dport"]
    $_state4 = $rule4["state"]
    $_source4 = $rule4["source"]
    $_src_range4 = $rule4["src_range"]
    $_destination4 = $rule4["destination"]
    $_dst_range4 = $rule4["dst_range"]
    $_iniface4 = $rule4["iniface"]
    $_outiface4 = $rule4["outiface"]
    $_icmp4 = $rule4["icmp"]
    $_chain4 = $rule4["chain"]
    $_provider4 = $rule4["provider"]
    $_log_level4 = $rule4["log_level"]
    $_log_prefix4 = $rule4["log_prefix"]
    $_jump4 = $rule4["jump"]
    $_limit4 = $rule4["limit"]
    $_table4 = $rule4["table"]
    $_toports4 = $rule4["toports"]
    $_setports4 = $rule4["setports"]
    $_setdscp4 = $rule4["setdscp"]
    $_ensure4 = $rule4["ensure"]
    $_tosource4  = $rule4["tosource"]
    $_algo4 = $rule4["algo"]
    $_string4 = $rule4["string"]

    rule { "${_title4}_4":
        name        => $_name4,
        proto       => $_proto4,
        action      => $_action4,
        sport       => $_sport4,
        dport       => $_dport4,
        state       => $_state4,
        source      => $_source4,
        src_range   => $_src_range4,
        destination => $_destination4,
        dst_range   => $_dst_range4,
        iniface     => $_iniface4,
        outiface    => $_outiface4,
        icmp        => $_icmp4,
        chain       => $_chain4,
        provider    => $_provider4,
        log_level   => $_log_level4,
        log_prefix  => $_log_prefix4,
        jump        => $_jump4,
        limit       => $_limit4,
        table       => $_table4,
        toports     => $_toports4,
        setdscp     => $_setdscp4,
        ensure      => $_ensure4,
        tosource    => $_tosource4,
        string      => $_string4,
        algo        => $_algo4,
    }
  }

}
